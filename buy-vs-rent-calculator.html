<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Buy vs Rent Calculator | Real Cost of Buying vs Renting in India</title>
    <meta name="description" content="Compare net worth outcomes of buying a house vs renting and investing in India. Includes HRA benefits, home loan interest deduction, moving costs, and investment returns." />
    <meta name="robots" content="index,follow,max-image-preview:large" />
    <link rel="canonical" href="https://financialcalc.ai/buy-vs-rent-calculator" />
    <link rel="icon" href="favicon.svg" type="image/svg+xml" />
    <link rel="shortcut icon" href="favicon.svg" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Buy vs Rent Calculator | Compare Real Estate Investment in India" />
    <meta property="og:description" content="Calculate and compare net worth outcomes of buying a house vs renting and investing. Includes tax benefits, moving costs, and year-by-year analysis." />
    <meta property="og:url" content="https://financialcalc.ai/buy-vs-rent-calculator" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <script type="application/ld+json">
    {
      "@context":"https://schema.org",
      "@type":"FAQPage",
      "mainEntity":[
        {
          "@type":"Question",
          "name":"Is it better to buy or rent a house in India?",
          "acceptedAnswer":{
            "@type":"Answer",
            "text":"The decision depends on multiple factors: property appreciation, investment returns, tax benefits, and your life plans. This calculator compares both scenarios with actual costs, tax benefits, and investment returns to help you decide."
          }
        },
        {
          "@type":"Question",
          "name":"What tax benefits do homebuyers get in India?",
          "acceptedAnswer":{
            "@type":"Answer",
            "text":"In OLD tax regime, homebuyers get: (1) Home loan interest deduction up to â‚¹200,000/year under Section 24b, (2) Home loan principal deduction up to â‚¹150,000/year under Section 80C. NEW regime offers no such deductions."
          }
        },
        {
          "@type":"Question",
          "name":"What are HRA benefits when renting in India?",
          "acceptedAnswer":{
            "@type":"Answer",
            "text":"In OLD regime, renters can claim HRA exemption: minimum of (1) HRA received, (2) rent minus 10% of salary, (3) 50% of salary in metros or 40% in non-metros. This reduces taxable income. NEW regime offers no HRA exemption."
          }
        }
      ]
    }
    </script>

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      /* Header Styling */
      header {
        background: var(--card, white);
        border-bottom: 1px solid var(--border, #d1e7e4);
        padding: 16px 0;
        position: sticky;
        top: 0;
        z-index: 100;
      }
      
      .header-content {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 clamp(16px, 3vw, 40px);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      
      .logo {
        font-weight: 700;
        font-size: 20px;
        text-decoration: none;
        color: var(--ink, #0f2f2e);
      }
      
      .mobile-menu-toggle {
        display: none;
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: var(--ink, #0f2f2e);
      }
      
      nav {
        display: flex;
      }
      
      .nav-links {
        display: flex;
        gap: 32px;
        list-style: none;
        padding: 0;
        margin: 0;
      }
      
      .nav-links a {
        text-decoration: none;
        color: var(--ink, #0f2f2e);
        font-size: 14px;
        font-weight: 500;
        transition: color 0.3s ease;
      }
      
      .nav-links a:hover {
        color: var(--brand, #0d9488);
      }
      
      @media (max-width: 700px) {
        .mobile-menu-toggle {
          display: block;
        }
        
        nav {
          display: none;
        }
        
        nav.active {
          display: flex;
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          flex-direction: column;
          background: var(--card, white);
          border-bottom: 1px solid var(--border, #d1e7e4);
          padding: 16px;
        }
        
        .nav-links {
          flex-direction: column;
          gap: 12px;
        }
      }

            /* Responsive layout improvements */
            @media (min-width: 1000px) {
              section[style*="grid-template-columns"] {
                gap: 10px !important;
              }
            }

            :root {
              --section-gap: clamp(16px, 3vw, 40px);
              --card-padding: clamp(10px, 3vw, 32px);
              --section-padding: clamp(8px, 2vw, 24px);
            }

            @media (max-width: 1200px) {
              .wrap {
                padding: 24px 2vw 60px 2vw;
              }
              .grid {
                grid-template-columns: 1fr !important;
              }
            }

            @media (max-width: 900px) {
              .wrap {
                padding: 12px 1vw 30px 1vw;
              }
              .grid {
                grid-template-columns: 1fr !important;
              }
              .card, .seo-card {
                padding: 12px 6px !important;
              }
              .results, .chart, .legend, .foot {
                font-size: 13px;
              }
              h1, h2 {
                font-size: 1.1rem !important;
              }
              table {
                font-size: 12px;
              }
              .input-row {
                grid-template-columns: 1fr !important;
              }
            }

            @media (max-width: 700px) {
              .wrap {
                padding: 4px 0 10px 0;
              }
              .card, .seo-card {
                padding: 8px 2px !important;
                border-radius: 10px;
              }
              .results, .chart, .legend, .foot {
                font-size: 11px;
              }
              h1, h2 {
                font-size: 1rem !important;
              }
              table {
                font-size: 10px;
              }
              .grid {
                grid-template-columns: 1fr !important;
              }
            }

      :root {
        --bg: #f0fdf9;
        --ink: #0f2f2e;
        --muted: #64748b;
        --brand: #0d9488;
        --brand-2: #0f766e;
        --accent: #5eead4;
        --card: #ffffff;
        --border: #d1e7e4;
        --shadow: 0 12px 32px rgba(13, 148, 136, 0.12);
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Inter", system-ui, -apple-system, Segoe UI, sans-serif;
        color: var(--ink);
        background: var(--bg);
        min-height: 100vh;
      }

      .wrap {
        width: 100%;
        padding: var(--section-gap);
      }

      h1 {
        margin: 0;
        font-size: clamp(26px, 3.4vw, 34px);
        line-height: 1.2;
        font-weight: 600;
      }

      .sub {
        color: var(--muted);
        margin: 8px 0 0;
        font-size: 14px;
        line-height: 1.5;
      }

      .grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--section-gap);
        margin-top: var(--section-gap);
        align-items: start;
      }

      .card {
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: 16px;
        box-shadow: var(--shadow);
        padding: var(--card-padding);
        min-width: 0;
        width: 100%;
        box-sizing: border-box;
      }

      .input-group {
        display: grid;
        gap: 8px;
        margin-bottom: 16px;
      }

      label {
        font-weight: 600;
        font-size: 13px;
        color: var(--ink);
        display: block;
        margin-bottom: 8px;
      }

      .unit {
        font-size: 12px;
        color: #9aa3b2;
        font-weight: 600;
        letter-spacing: 0.04em;
      }

      .input-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 8px;
      }

      .slider-container {
        display: grid;
        gap: 8px;
      }

      .slider-wrapper {
        width: 100%;
      }

      input[type="range"] {
        width: 100%;
        accent-color: var(--brand);
        height: 4px;
        background: #e5e7eb;
        border-radius: 999px;
        cursor: pointer;
      }

      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 16px;
        height: 16px;
        border-radius: 1000%;
        background: var(--brand);
        border: none;
        margin-top: -6px;
        box-shadow: 0 4px 10px rgba(13, 148, 136, 0.35);
      }

      input[type="number"],
      input[type="text"],
      select {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid var(--border);
        border-radius: 8px;
        font-weight: 600;
        font-size: 13px;
        background: #fff;
        color: var(--ink);
        font-family: "Inter", sans-serif;
        transition: border-color 0.2s, box-shadow 0.2s;
      }

      input[type="number"]:focus,
      input[type="text"]:focus,
      select:focus {
        outline: none;
        border-color: var(--brand);
        box-shadow: 0 0 0 3px rgba(13, 148, 136, 0.1);
      }

      select {
        cursor: pointer;
      }

      .results {
        display: grid;
        gap: 10px;
        margin-bottom: 12px;
      }

      .results > div {
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-weight: 600;
        padding: 12px 14px;
        background: #f8f9fb;
        border-radius: 10px;
        border-left: 4px solid transparent;
        transition: all 0.2s;
      }

      .results > div:hover {
        background: #f0f4f7;
        border-left-color: var(--brand);
      }

      .results > div span {
        color: #6b7280;
        font-weight: 500;
        font-size: 13px;
        flex: 1;
      }

      .results > div strong {
        font-size: 15px;
        font-weight: 700;
        color: var(--brand);
        text-align: right;
        word-break: break-word;
      }

      .result-heading {
        font-size: 13px;
        font-weight: 600;
        margin: 18px 0 12px 0;
        color: var(--brand);
        border-bottom: 2px solid var(--border);
        padding-bottom: 8px;
      }

      .cta {
        margin-top: 20px;
        background: var(--brand);
        border: none;
        color: #fff;
        padding: 12px 16px;
        width: 100%;
        border-radius: 10px;
        font-weight: 600;
        font-size: 13px;
        letter-spacing: 0.03em;
        box-shadow: 0 8px 18px rgba(13, 148, 136, 0.25);
        cursor: pointer;
        transition: background 0.2s, transform 0.2s;
      }

      .cta:hover {
        transform: translateY(-2px);
      }

      .cta:hover {
        background: var(--brand-2);
      }

      .foot {
        margin-top: 18px;
        color: #9aa3b2;
        font-size: 12px;
        text-align: center;
      }

      section {
        margin-bottom: var(--section-gap);
      }

      .toggle-section {
        background: #f8f9fb;
        border-radius: 8px;
        padding: 12px;
        margin-top: 12px;
        border-left: 4px solid var(--brand);
      }

      .toggle-section.hidden {
        display: none;
      }

      .toggle-section h3 {
        margin-bottom: 10px;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        font-size: 12px;
      }

      th, td {
        padding: 10px 8px;
        text-align: right;
        border-bottom: 1px solid var(--border);
      }

      th {
        background: #f8f9fb;
        font-weight: 600;
        color: #6b7280;
        text-align: left;
      }

      th:first-child,
      td:first-child {
        text-align: left;
      }

      .seo-section {
        width: 100%;
        margin: var(--section-gap) 0;
        display: flex;
        flex-direction: column;
        gap: var(--section-gap);
        padding: 0;
      }

      .seo-card {
        background: var(--card);
        border: 1.5px solid #d1e7e4;
        border-radius: 18px;
        box-shadow: 0 8px 32px rgba(13, 148, 136, 0.10);
        padding: var(--card-padding);
        line-height: 1.85;
        font-size: 1.08rem;
        color: #18313a;
        transition: box-shadow 0.2s;
        min-width: 0;
        width: 100%;
        box-sizing: border-box;
      }

      .seo-card h2 {
        font-size: 1.45rem;
        margin-bottom: 18px;
        color: var(--brand-2);
        font-weight: 700;
        letter-spacing: 0.01em;
      }

      .seo-card p, .seo-card ul, .seo-card ol {
        margin-bottom: 16px;
      }

      .seo-card ul, .seo-card ol {
        padding-left: 24px;
      }

      .seo-card li {
        margin-bottom: 10px;
        line-height: 1.7;
      }

      .seo-card strong {
        color: var(--brand);
      }

      .seo-card em {
        color: #64748b;
        font-style: italic;
      }

      .mode-toggle {
        display: inline-flex;
        gap: 8px;
        align-items: center;
        margin: 8px 0 4px;
      }

      .mode-toggle button {
        background: #fff;
        border: 1px solid var(--border);
        color: #0f172a;
        padding: 8px 12px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
      }

      .mode-toggle button.active {
        border-color: var(--brand);
        color: var(--brand);
        background: #ecfeff;
      }

      .simple-mode .advanced-only {
        display: none !important;
      }
    </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="header-content">
      <a href="index.html" class="logo">ðŸ’° FinancialCalc.ai</a>
      <button class="mobile-menu-toggle" aria-label="Toggle menu">â˜°</button>
      <nav>
        <ul class="nav-links">
          <li><a href="index.html">Home</a></li>
          <li><a href="index.html#investing">Investing</a></li>
          <li><a href="index.html#home-decisions">House Decisions</a></li>
          <li><a href="index.html#loans">Loans</a></li>
          <li><a href="index.html#retirement">Retirement</a></li>
          <li><a href="contact.html">Contact Us</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="wrap">
    <h1>Buy vs Rent Calculator for India</h1>
    <p class="sub">Compare long-term net worth of buying a home vs renting and investing the difference, including taxes, costs, and returns.</p>

    <!-- Main Section: Inputs + Results -->
    <section class="grid">
      <!-- Left Column: Inputs -->
      <div class="card">
        <h2 style="margin-bottom: 16px; font-size: 16px; font-weight: 600;">Calculator Inputs</h2>

        <div class="mode-toggle" role="group" aria-label="Calculator mode">
          <button id="simpleModeBtn" type="button" class="active">Simple</button>
          <button id="advancedModeBtn" type="button">Advanced</button>
        </div>

        <!-- Buy Route Inputs -->
        <h3 style="font-size: 13px; font-weight: 600; margin-top: 16px; margin-bottom: 10px; color: var(--brand);">BUY ROUTE</h3>
        
        <div class="input-row">
          <div class="input-group">
            <label for="housePriceInput">Cost of House (Lakhs)</label>
            <div class="slider-wrapper">
              <input type="range" id="housePriceRange" min="10" max="500" value="80" aria-label="Cost of House Range">
            </div>
            <input type="number" id="housePriceInput" min="10" max="500" value="80" aria-label="Cost of House">
          </div>
          <div class="input-group">
            <label for="furnishingInput">Furnishing Cost (Lakhs)</label>
            <div class="slider-wrapper">
              <input type="range" id="furnishingRange" min="0" max="50" value="10" aria-label="Furnishing Cost Range">
            </div>
            <input type="number" id="furnishingInput" min="0" max="50" value="10" aria-label="Furnishing Cost">
          </div>
        </div>

        <div class="input-row">
          <div class="input-group advanced-only">
            <label for="registrationInput">Registration Cost (%)</label>
            <div class="slider-wrapper">
              <input type="range" id="registrationRange" min="0" max="20" value="8" step="0.5" aria-label="Registration Cost Range">
            </div>
            <input type="number" id="registrationInput" min="0" max="20" value="8" step="0.5" aria-label="Registration Cost">
          </div>
          <div class="input-group advanced-only">
            <label for="houseMaintInput">House Maintenance (â‚¹/month)</label>
            <div class="slider-wrapper">
              <input type="range" id="houseMaintRange" min="0" max="50000" value="5000" step="500" aria-label="House Maintenance Range">
            </div>
            <input type="number" id="houseMaintInput" min="0" max="50000" value="5000" step="500" aria-label="House Maintenance">
          </div>
        </div>

        <div class="input-row">
          <div class="input-group advanced-only">
            <label for="societyMaintInput">Society Maintenance (â‚¹/month)</label>
            <div class="slider-wrapper">
              <input type="range" id="societyMaintRange" min="0" max="20000" value="3000" step="500" aria-label="Society Maintenance Range">
            </div>
            <input type="number" id="societyMaintInput" min="0" max="20000" value="3000" step="500" aria-label="Society Maintenance">
          </div>
          <div class="input-group advanced-only">
            <label for="insuranceInput">Home Insurance (â‚¹/year)</label>
            <div class="slider-wrapper">
              <input type="range" id="insuranceRange" min="0" max="100000" value="6000" step="1000" aria-label="Insurance Range">
            </div>
            <input type="number" id="insuranceInput" min="0" max="100000" value="6000" step="1000" aria-label="Insurance">
          </div>
        </div>

        <div class="input-row">
          <div class="input-group">
            <label for="loanPctInput">Loan Financing (%)</label>
            <div class="slider-wrapper">
              <input type="range" id="loanPctRange" min="0" max="100" value="70" aria-label="Loan Financing Range">
            </div>
            <input type="number" id="loanPctInput" min="0" max="100" value="70" aria-label="Loan Financing">
          </div>
          <div class="input-group">
            <label for="tenureInput">Loan Tenure (Years)</label>
            <div class="slider-wrapper">
              <input type="range" id="tenureRange" min="1" max="40" value="20" aria-label="Loan Tenure Range">
            </div>
            <input type="number" id="tenureInput" min="1" max="40" value="20" aria-label="Loan Tenure">
          </div>
        </div>

        <div class="input-row">
          <div class="input-group">
            <label for="rateInput">Loan Interest Rate (% p.a.)</label>
            <div class="slider-wrapper">
              <input type="range" id="rateRange" min="2" max="15" value="8.5" step="0.1" aria-label="Interest Rate Range">
            </div>
            <input type="number" id="rateInput" min="2" max="15" value="8.5" step="0.1" aria-label="Interest Rate">
          </div>
          <div class="input-group">
            <label for="appreciationInput">Home Appreciation (% p.a.)</label>
            <div class="slider-wrapper">
              <input type="range" id="appreciationRange" min="0" max="15" value="5" step="0.5" aria-label="Appreciation Rate Range">
            </div>
            <input type="number" id="appreciationInput" min="0" max="15" value="5" step="0.5" aria-label="Appreciation Rate">
          </div>
        </div>

        <!-- Rent Route Inputs -->
        <h3 style="font-size: 13px; font-weight: 600; margin-top: 16px; margin-bottom: 10px; color: var(--brand);">RENT ROUTE</h3>

        <div class="input-row">
          <div class="input-group">
            <label for="currentRentInput">Current Rent (â‚¹/month)</label>
            <div class="slider-wrapper">
              <input type="range" id="currentRentRange" min="0" max="100000" value="30000" step="1000" aria-label="Current Rent Range">
            </div>
            <input type="number" id="currentRentInput" min="0" max="100000" value="30000" step="1000" aria-label="Current Rent">
          </div>
          <div class="input-group">
            <label for="investmentReturnsInput">Expected Investment Returns (% p.a.)</label>
            <div class="slider-wrapper">
              <input type="range" id="investmentReturnsRange" min="0" max="30" value="12" step="0.5" aria-label="Investment Returns Range">
            </div>
            <input type="number" id="investmentReturnsInput" min="0" max="30" value="12" step="0.5" aria-label="Investment Returns">
          </div>
        </div>

        <div class="input-row">
          <div class="input-group advanced-only">
            <label for="rentIncreaseInput">Yearly Rent Increase (%)</label>
            <div class="slider-wrapper">
              <input type="range" id="rentIncreaseRange" min="0" max="15" value="5" step="0.5" aria-label="Rent Increase Range">
            </div>
            <input type="number" id="rentIncreaseInput" min="0" max="15" value="5" step="0.5" aria-label="Rent Increase">
          </div>
          <div class="input-group advanced-only">
            <label for="sipPercentageInput">Monthly SIP Investment (% of EMI)</label>
            <div class="slider-wrapper">
              <input type="range" id="sipPercentageRange" min="0" max="100" value="100" step="5" aria-label="SIP Percentage Range">
            </div>
            <input type="number" id="sipPercentageInput" min="0" max="100" value="100" step="5" aria-label="SIP Percentage of EMI">
          </div>
        </div>
      </div>

      <!-- Right Column: Results -->
      <div class="card">
        <h2 style="margin-bottom: 16px; font-size: 16px; font-weight: 600;">Comparison at Year <span id="yearsValue">20</span></h2>
        
        <!-- Year Slider -->
        <div style="background: #f8f9fb; border-radius: 8px; padding: 16px; margin-bottom: 20px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
            <span style="font-weight: 600; font-size: 14px;">Year Held:</span>
            <span id="yearsHeldValue" style="color: var(--brand); font-weight: 700; font-size: 18px;">20</span>
          </div>
          <input id="yearsHeldSlider" type="range" min="1" max="40" step="1" value="20" aria-label="Years Held Slider" style="width: 100%;" />
          <div style="font-size: 12px; color: #9aa3b2; margin-top: 8px;" id="yearsHeldRange">1 - 40 years</div>
        </div>

        <!-- Comparison -->
        <h3 class="result-heading">COMPARISON</h3>
        <div class="results">
          <div><span>Total Asset When Buying Home</span><strong id="buyNetWorthFinalResult" style="color: var(--brand);">â‚¹ 0</strong></div>
          <div><span>Total Asset When Renting</span><strong id="rentNetWorthFinalResult" style="color: var(--brand);">â‚¹ 0</strong></div>
          <div style="background: #fef3c7; border-left-color: #f59e0b;"><span style="color: #92400e;">Winner (Difference)</span><strong id="differenceResult" style="color: #dc2626;">Buy (â‚¹ 0)</strong></div>
        </div>

        <!-- Buy Route Results -->
        <h3 class="result-heading">BUY ROUTE</h3>
        <div class="results">
          <div><span>Upfront Money Required</span><strong id="buyUpfrontResult">â‚¹ 0</strong></div>
          <div><span>Monthly EMI</span><strong id="buyEMIResult">â‚¹ 0</strong></div>
          <div><span>All Other Costs Over Time</span><strong id="buyOtherCostsResult">â‚¹ 0</strong></div>
          <div><span>Total SIP Invested (Average)</span><strong id="buyMonthlySIPResult">â‚¹ 0</strong></div>
          <div><span>Final Value of SIP Investment</span><strong id="buySIPFVResult">â‚¹ 0</strong></div>
          <div><span>House Value</span><strong id="buyHouseValueResult">â‚¹ 0</strong></div>
          <div style="background: #e0f2f1;"><span>Total Value</span><strong id="buyTotalValueResult" style="color: var(--brand);">â‚¹ 0</strong></div>
        </div>

        <!-- Rent Route Results -->
        <h3 class="result-heading">RENT ROUTE</h3>
        <div class="results">
          <div><span>Lumpsum Investment (at Start)</span><strong id="rentLumpsumStartResult">â‚¹ 0</strong></div>
          <div><span>Total SIP Invested (Average)</span><strong id="rentMonthlySIPResult">â‚¹ 0</strong></div>
          <div><span>Value of Lumpsum Investment</span><strong id="rentLumpsumFVResult">â‚¹ 0</strong></div>
          <div><span>Value of SIP Investments</span><strong id="rentSIPFVResult">â‚¹ 0</strong></div>
          <div style="background: #e0f2f1;"><span>Total Investment Value</span><strong id="rentTotalInvestmentResult" style="color: var(--brand);">â‚¹ 0</strong></div>
        </div>

        <button class="cta">DETAILED ANALYSIS</button>
        <div class="foot">For illustration only. Tax benefits and returns are estimates based on assumptions.</div>
      </div>
    </section>

    <!-- Charts Section -->
    <section class="grid">
      <div class="card">
        <h2 style="margin: 0 0 16px 0; font-size: 16px; font-weight: 600;">Net Worth Comparison</h2>
        <canvas id="netWorthComparisonChart"></canvas>
      </div>
      <div class="card">
        <h2 style="margin: 0 0 16px 0; font-size: 16px; font-weight: 600;">Wealth Growth Over Years</h2>
        <canvas id="wealthGrowthChart"></canvas>
      </div>
    </section>

    <!-- Year-by-Year Comparison Table -->
    <section>
      <div class="card">
        <h2 style="margin: 0 0 16px 0; font-size: 16px; font-weight: 600;">Year-by-Year Breakdown</h2>
        <div style="overflow-x: auto; font-size: 12px;">
          <table>
            <thead>
              <tr style="background: #f8f9fb; border-bottom: 2px solid var(--border);">
                <th>Year</th>
                <th>Monthly Rent</th>
                <th>Annual Rent</th>
                <th>Moving Cost</th>
                <th>SIP Contribution</th>
                <th>Lumpsum FV</th>
                <th>SIP FV</th>
                <th>Total Investment</th>
                <th>House Value</th>
                <th>Loan Remaining</th>
                <th>House Equity</th>
                <th>Buy vs Rent Diff</th>
              </tr>
            </thead>
            <tbody id="comparisonTableBody">
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- SEO Content -->
    <div class="seo-section">
      <div class="seo-card">
        <h2>Buy vs Rent: Understanding the Decision in India</h2>
        <p>One of the biggest financial decisions in India is whether to buy a house or rent and invest the difference. This calculator compares the long-term wealth outcomes of both scenarios based on your inputs.</p>
        <p>The comparison includes EMI, property taxes, maintenance, insurance, registration fees, rent escalation, HRA tax benefits, moving costs, and investment returns.</p>
      </div>

      <div class="seo-card">
        <h2>Key Factors in Buy vs Rent Analysis</h2>
        <ul>
          <li><strong>Home Appreciation:</strong> Real estate typically appreciates 4-6% annually in major Indian cities, building equity over time.</li>
          <li><strong>Tax Benefits:</strong> Home loan interest deduction (Section 24b) in OLD regime can reduce taxable income up to â‚¹200,000/year.</li>
          <li><strong>HRA Benefits:</strong> Renters can claim HRA exemption in OLD regime (50% in metros, 40% elsewhere).</li>
          <li><strong>Investment Returns:</strong> Money saved by renting can be invested in SIPs, stocks, or bonds; historical equity returns average ~10-14% p.a.</li>
          <li><strong>Moving Costs:</strong> Renting can involve periodic moving costs (assumed every 4 years, ~1 monthâ€™s rent).</li>
        </ul>
      </div>

      <div class="seo-card">
        <h2>How HRA Tax Benefits Work</h2>
        <p>In the OLD tax regime, you can claim HRA exemption while renting. The exemption is the least of:</p>
        <ul>
          <li>HRA actually received from employer</li>
          <li>Rent paid minus 10% of basic salary</li>
          <li>50% of basic salary (in metro cities) or 40% (in non-metro cities)</li>
        </ul>
        <p>This exemption reduces taxable income, saving tax based on your slab (illustrated at 30%). In the NEW regime, no HRA exemption is available.</p>
      </div>

      <div class="seo-card">
        <h2>Home Loan Interest Deduction (Section 24b)</h2>
        <p>If you buy a home, you can deduct home loan interest (up to â‚¹200,000/year) from taxable income under the OLD regime. This reduces tax based on your slab.</p>
        <p>Example: On a â‚¹50L loan at 8.5%, first-year interest is ~â‚¹4.2L. Deduction would be min(â‚¹4.2L, â‚¹2L) = â‚¹2L, saving ~â‚¹60,000 in taxes at a 30% slab.</p>
        <p>The NEW regime does not offer this deduction, which can shift the buy vs rent outcome.</p>
      </div>

      <div class="seo-card">
        <h2>Assumptions in This Calculator</h2>
        <ul>
          <li>Tax bracket is fixed at 30% for illustration (adjust for your slab)</li>
          <li>Property tax is 0.5% of house value annually</li>
          <li>House and society maintenance costs increase 2% annually (compounded)</li>
          <li>Moving costs occur every 4 years during renting (assumed = 1 monthâ€™s rent)</li>
          <li>Investment returns are compounded annually</li>
          <li>Rental income is taxed at 30% in both regimes (simplification)</li>
          <li>HRA benefits apply only in OLD regime; NEW regime has no tax deductions</li>
        </ul>
      </div>

      <div class="seo-card">
        <h2>Using This Calculator for Your Decision</h2>
        <p>Enter your house price, loan parameters, current rent, and expected investment returns. The calculator will show:</p>
        <ul>
          <li>Net worth at each year for both buying and renting scenarios</li>
          <li>Detailed year-by-year breakdown of costs and tax benefits</li>
          <li>Charts comparing wealth growth</li>
          <li>The net worth difference at your chosen time horizon</li>
        </ul>
        <p>Use different scenarios to understand how changes in house price, appreciation rate, or investment returns affect your decision.</p>
      </div>

      <div class="seo-card">
        <h2>When is Buying Better? When is Renting Better?</h2>
        <p><strong>Buying may be better if:</strong> You plan to stay 10+ years, expect strong appreciation, have stable EMI capacity, and can use OLD-regime deductions.</p>
        <p><strong>Renting may be better if:</strong> You value flexibility, expect lower appreciation, can earn higher market returns, or prefer liquidity.</p>
        <p>The best choice depends on your situation. Use this calculator to quantify the outcomes and decide confidently.</p>
      </div>

      <div class="seo-card">
        <h2>Final Note and Disclaimer</h2>
        <p>This calculator is for educational and planning purposes only and does not constitute financial advice. Results are illustrative and not guaranteed. Taxes, fees, charges, and market risks are not included in the calculations. Consult a qualified financial advisor before making housing or investment decisions.</p>
      </div>
    </div>
  </div>

  <script>
    // ======================= UTILITY FUNCTIONS =======================
    function formatINR(value) {
      if (isNaN(value) || value === null) return 'â‚¹ 0';
      const absValue = Math.abs(value);
      if (absValue >= 10000000) return 'â‚¹ ' + (value / 10000000).toFixed(2) + 'Cr';
      if (absValue >= 100000) return 'â‚¹ ' + (value / 100000).toFixed(2) + 'L';
      return 'â‚¹ ' + Math.round(value).toLocaleString('en-IN');
    }

    function syncInput(rangeId, textId) {
      const range = document.getElementById(rangeId);
      const text = document.getElementById(textId);
      range.addEventListener('input', () => {
        text.value = range.value;
        calculate();
      });
      text.addEventListener('input', () => {
        range.value = text.value;
        calculate();
      });
    }

    // ======================= FINANCIAL CALCULATIONS =======================
    function computeEMI(principalINR, annualRate, tenureYears) {
      if (principalINR === 0 || annualRate === 0) return 0;
      const monthlyRate = annualRate / 100 / 12;
      const months = tenureYears * 12;
      return (principalINR * monthlyRate * Math.pow(1 + monthlyRate, months)) / (Math.pow(1 + monthlyRate, months) - 1);
    }

    function buildAmortizationSchedule(loanAmountINR, annualRate, tenureYears) {
      if (loanAmountINR === 0 || annualRate === 0) return [];
      const monthlyRate = annualRate / 100 / 12;
      const emi = computeEMI(loanAmountINR, annualRate, tenureYears);
      const schedule = [];
      let balance = loanAmountINR;

      for (let month = 0; month < tenureYears * 12; month++) {
        const interest = balance * monthlyRate;
        const principal = emi - interest;
        balance -= principal;
        schedule.push({
          month,
          emi,
          principal: Math.max(0, principal),
          interest,
          balance: Math.max(0, balance)
        });
      }
      return schedule;
    }

    function aggregateYearlyRows(monthlySchedule, housePriceINR, houseMaintMonthly, societyMaintMonthly, insuranceAnnual, taxRegime) {
      const yearlyRows = [];
      let yearIndex = 1;
      let monthStart = 0;

      while (monthStart < monthlySchedule.length) {
        const monthEnd = Math.min(monthStart + 12, monthlySchedule.length);
        let totalPrincipal = 0, totalInterest = 0, totalEMI = 0;

        for (let m = monthStart; m < monthEnd; m++) {
          const row = monthlySchedule[m];
          totalPrincipal += row.principal;
          totalInterest += row.interest;
          totalEMI += row.emi;
        }

        const openingBalance = monthStart === 0 ? monthlySchedule[0]?.balance + totalPrincipal : monthlySchedule[monthStart - 1]?.balance;
        const closingBalance = monthlySchedule[monthEnd - 1]?.balance;
        const houseMaintAnnual = houseMaintMonthly * 12 * Math.pow(1.02, yearIndex - 1);
        const societyMaintAnnual = societyMaintMonthly * 12 * Math.pow(1.02, yearIndex - 1);
        const propertyTax = (housePriceINR * 0.005);

        let taxBenefit = 0;
        if (taxRegime === 'OLD') {
          const deductibleInterest = Math.min(totalInterest, 200000);
          taxBenefit = deductibleInterest * 0.30;
        }

        const yearTotal = totalEMI + propertyTax + houseMaintAnnual + societyMaintAnnual + insuranceAnnual - taxBenefit;

        yearlyRows.push({
          year: yearIndex,
          openingBalance,
          principal: totalPrincipal,
          interest: totalInterest,
          closingBalance,
          emiTotal: totalEMI,
          propertyTax,
          houseMaint: houseMaintAnnual,
          societyMaint: societyMaintAnnual,
          insurance: insuranceAnnual,
          taxBenefit,
          yearTotal
        });

        monthStart = monthEnd;
        yearIndex++;
      }

      return yearlyRows;
    }

    function computeTotalsForYearsHeld(yearlyRows, yearsHeld, upfrontPayment) {
      let totalPrincipal = 0, totalInterest = 0, totalEMI = 0, totalPropertyTax = 0;
      let totalHouseMaint = 0, totalSocietyMaint = 0, totalInsurance = 0, totalTaxBenefit = 0;

      const endYear = Math.min(yearsHeld, yearlyRows.length);
      for (let i = 0; i < endYear; i++) {
        const row = yearlyRows[i];
        totalPrincipal += row.principal;
        totalInterest += row.interest;
        totalEMI += row.emiTotal;
        totalPropertyTax += row.propertyTax;
        totalHouseMaint += row.houseMaint;
        totalSocietyMaint += row.societyMaint;
        totalInsurance += row.insurance;
        totalTaxBenefit += row.taxBenefit;
      }

      const totalCost = upfrontPayment + totalEMI + totalPropertyTax + totalHouseMaint + totalSocietyMaint + totalInsurance - totalTaxBenefit;

      return {
        totalPrincipal,
        totalInterest,
        totalEMI,
        totalPropertyTax,
        totalHouseMaint,
        totalSocietyMaint,
        totalInsurance,
        totalTaxBenefit,
        totalCost
      };
    }

    // ======================= HRA CALCULATION =======================
    function computeHraExemption(basicSalaryYear0, hraReceived, rentPaidMonthly, cityType, yearNumber) {
      // Salary increases 5% annually
      const basicSalaryAtYear = basicSalaryYear0 * Math.pow(1.05, yearNumber - 1);
      const hraReceivedAtYear = hraReceived * Math.pow(1.05, yearNumber - 1);
      
      const rentPaidAnnual = rentPaidMonthly * 12;
      const hraPercentage = cityType === 'METRO' ? 0.50 : 0.40;
      const hraLimit = hraPercentage * basicSalaryAtYear;
      const rentLessTenPercent = rentPaidAnnual - 0.10 * basicSalaryAtYear;

      return Math.max(0, Math.min(hraReceivedAtYear, rentLessTenPercent, hraLimit));
    }

    function computeHraTaxSavings(basicSalaryYear0, hraReceived, rentPaidMonthly, cityType, taxRegime, yearNumber) {
      // HRA exemption only available in OLD regime
      if (taxRegime === 'NEW') return 0;
      const exempt = computeHraExemption(basicSalaryYear0, hraReceived, rentPaidMonthly, cityType, yearNumber);
      return exempt * 0.30;
    }

    // ======================= SIP & LUMPSUM CALCULATIONS =======================
    function computeSipFutureValue(monthlyAmount, annualRate, months) {
      if (monthlyAmount === 0 || months === 0) return 0;
      const monthlyRate = Math.pow(1 + annualRate / 100, 1 / 12) - 1;
      if (monthlyRate === 0) return monthlyAmount * months;
      return monthlyAmount * (Math.pow(1 + monthlyRate, months) - 1) / monthlyRate * (1 + monthlyRate);
    }

    function computeLumpsumFutureValue(principal, annualRate, months) {
      if (principal === 0) return 0;
      const yearlyRate = annualRate / 100;
      const years = months / 12;
      return principal * Math.pow(1 + yearlyRate, years);
    }

    function calculateMonthlyFromFV(futureValue, monthlyReturnRate, totalMonths) {
      if (futureValue === 0 || totalMonths === 0) return 0;
      // SIP FV formula: FV = P * [((1 + r)^n - 1) / r] * (1 + r)
      // Solving for P: P = FV / [((1 + r)^n - 1) / r * (1 + r)]
      const raisedPower = Math.pow(1 + monthlyReturnRate, totalMonths);
      const denominator = ((raisedPower - 1) / monthlyReturnRate) * (1 + monthlyReturnRate);
      return futureValue / denominator;
    }

    // ======================= MAIN CALCULATION FLOW =======================
    syncInput('housePriceRange', 'housePriceInput');
    syncInput('registrationRange', 'registrationInput');
    syncInput('furnishingRange', 'furnishingInput');
    syncInput('houseMaintRange', 'houseMaintInput');
    syncInput('societyMaintRange', 'societyMaintInput');
    syncInput('insuranceRange', 'insuranceInput');
    syncInput('loanPctRange', 'loanPctInput');
    syncInput('tenureRange', 'tenureInput');
    syncInput('rateRange', 'rateInput');
    syncInput('appreciationRange', 'appreciationInput');
    syncInput('currentRentRange', 'currentRentInput');
    syncInput('rentIncreaseRange', 'rentIncreaseInput');
    syncInput('sipPercentageRange', 'sipPercentageInput');
    syncInput('investmentReturnsRange', 'investmentReturnsInput');

    const inputs = {
      housePriceInput: document.getElementById('housePriceInput'),
      registrationInput: document.getElementById('registrationInput'),
      furnishingInput: document.getElementById('furnishingInput'),
      houseMaintInput: document.getElementById('houseMaintInput'),
      societyMaintInput: document.getElementById('societyMaintInput'),
      insuranceInput: document.getElementById('insuranceInput'),
      loanPctInput: document.getElementById('loanPctInput'),
      tenureInput: document.getElementById('tenureInput'),
      rateInput: document.getElementById('rateInput'),
      appreciationInput: document.getElementById('appreciationInput'),
      currentRentInput: document.getElementById('currentRentInput'),
      rentIncreaseInput: document.getElementById('rentIncreaseInput'),
      sipPercentageInput: document.getElementById('sipPercentageInput'),
      investmentReturnsInput: document.getElementById('investmentReturnsInput'),
      loanTenureInput: document.getElementById('tenureInput'),
      loanRateInput: document.getElementById('rateInput')
    };

    const outputs = {
      buyUpfrontResult: document.getElementById('buyUpfrontResult'),
      buyEMIResult: document.getElementById('buyEMIResult'),
      buyOtherCostsResult: document.getElementById('buyOtherCostsResult'),
      buyMonthlySIPResult: document.getElementById('buyMonthlySIPResult'),
      buySIPFVResult: document.getElementById('buySIPFVResult'),
      buyHouseValueResult: document.getElementById('buyHouseValueResult'),
      buyTotalValueResult: document.getElementById('buyTotalValueResult'),
      rentLumpsumStartResult: document.getElementById('rentLumpsumStartResult'),
      rentMonthlySIPResult: document.getElementById('rentMonthlySIPResult'),
      rentLumpsumFVResult: document.getElementById('rentLumpsumFVResult'),
      rentSIPFVResult: document.getElementById('rentSIPFVResult'),
      rentTotalInvestmentResult: document.getElementById('rentTotalInvestmentResult'),
      buyNetWorthFinalResult: document.getElementById('buyNetWorthFinalResult'),
      rentNetWorthFinalResult: document.getElementById('rentNetWorthFinalResult'),
      differenceResult: document.getElementById('differenceResult'),
      yearsValue: document.getElementById('yearsValue')
    };

    let cachedYearlyRows = [];
    let cachedUpfront = 0;
    let comparisonChartInstance = null;
    let wealthGrowthChartInstance = null;

    const simpleModeBtn = document.getElementById('simpleModeBtn');
    const advancedModeBtn = document.getElementById('advancedModeBtn');

    function setMode(mode) {
      const isSimple = mode === 'simple';
      document.body.classList.toggle('simple-mode', isSimple);
      simpleModeBtn.classList.toggle('active', isSimple);
      advancedModeBtn.classList.toggle('active', !isSimple);
      localStorage.setItem('calculatorMode', mode);
    }

    simpleModeBtn.addEventListener('click', () => setMode('simple'));
    advancedModeBtn.addEventListener('click', () => setMode('advanced'));

    const savedMode = localStorage.getItem('calculatorMode') || 'simple';
    setMode(savedMode);

    function calculate() {
      const housePriceLakhs = parseFloat(inputs.housePriceInput.value) || 0;
      const housePriceINR = housePriceLakhs * 100000;
      const registrationPct = parseFloat(inputs.registrationInput.value) || 0;
      const furnishingLakhs = parseFloat(inputs.furnishingInput.value) || 0;
      const furnishingINR = furnishingLakhs * 100000;
      const houseMaintMonthly = parseFloat(inputs.houseMaintInput.value) || 0;
      const societyMaintMonthly = parseFloat(inputs.societyMaintInput.value) || 0;
      const insuranceAnnual = parseFloat(inputs.insuranceInput.value) || 0;
      const loanFinancingPct = parseFloat(inputs.loanPctInput.value) || 0;
      const tenureYears = parseInt(inputs.tenureInput.value) || 1;
      const annualRate = parseFloat(inputs.rateInput.value) || 0;
      const appreciationRate = parseFloat(inputs.appreciationInput.value) || 0;
      const taxRegime = 'NEW';  // Always NEW regime

      // Update slider max to match loan tenure
      const yearsHeldSlider = document.getElementById('yearsHeldSlider');
      const yearsHeldRange = document.getElementById('yearsHeldRange');
      yearsHeldSlider.max = tenureYears;
      yearsHeldRange.textContent = `1 - ${tenureYears} years`;
      
      // Initialize to tenure on first load, or clamp when tenure reduces
      const yearsHeldValueEl = document.getElementById('yearsHeldValue');
      const isManual = yearsHeldSlider.dataset.manual === 'true';
      const currentValue = parseInt(yearsHeldSlider.value) || tenureYears;

      if (!isManual || currentValue > tenureYears) {
        yearsHeldSlider.value = tenureYears;
        yearsHeldValueEl.textContent = tenureYears;
        document.getElementById('yearsValue').textContent = tenureYears;
      }

      const loanAmountINR = (housePriceINR * loanFinancingPct) / 100;
      const downPaymentINR = housePriceINR - loanAmountINR;
      const registrationINR = (housePriceINR * registrationPct) / 100;
      cachedUpfront = registrationINR + furnishingINR + downPaymentINR;

      const emi = computeEMI(loanAmountINR, annualRate, tenureYears);
      const monthlySchedule = buildAmortizationSchedule(loanAmountINR, annualRate, tenureYears);
      cachedYearlyRows = aggregateYearlyRows(monthlySchedule, housePriceINR, houseMaintMonthly, societyMaintMonthly, insuranceAnnual, taxRegime);

      // Get selected year from slider, default to full tenure
      const selectedYear = parseInt(yearsHeldSlider.value) || tenureYears;
      updateResults(selectedYear, emi, housePriceINR, loanAmountINR, registrationINR, furnishingINR, tenureYears);
    }

    function updateResults(yearsHorizon, emi, housePriceINR, loanAmountINR, registrationINR, furnishingINR, tenureYears) {
      outputs.yearsValue.textContent = yearsHorizon;

      // ========== BUY ROUTE ==========
      const buyTotals = computeTotalsForYearsHeld(cachedYearlyRows, yearsHorizon, cachedUpfront);
      const buyHouseValue = housePriceINR * Math.pow(1 + parseFloat(inputs.appreciationInput.value || 0) / 100, yearsHorizon);
      const buyLoanRemaining = yearsHorizon <= cachedYearlyRows.length ? cachedYearlyRows[yearsHorizon - 1]?.closingBalance || 0 : 0;
      const buyEquity = buyHouseValue - buyLoanRemaining;

      outputs.buyEMIResult.textContent = formatINR(emi);
      outputs.buyUpfrontResult.textContent = formatINR(cachedUpfront);
      const buyOtherCosts = (buyTotals.totalPropertyTax || 0) + (buyTotals.totalHouseMaint || 0) + (buyTotals.totalSocietyMaint || 0) + (buyTotals.totalInsurance || 0);
      outputs.buyOtherCostsResult.textContent = formatINR(buyOtherCosts);
      outputs.buyHouseValueResult.textContent = formatINR(buyHouseValue);

      // ========== RENT ROUTE ==========
      const currentRentMonthly = parseFloat(inputs.currentRentInput.value) || 0;
      const rentIncrease = parseFloat(inputs.rentIncreaseInput.value) || 0;
      const investmentReturns = parseFloat(inputs.investmentReturnsInput.value) || 0;
      const sipPercentage = parseFloat(inputs.sipPercentageInput.value) || 100;
      const emiThreshold = (emi * sipPercentage) / 100;

      // Get house cost inputs for SIP calculation
      const houseMaintMonthly = parseFloat(inputs.houseMaintInput.value) || 0;
      const societyMaintMonthly = parseFloat(inputs.societyMaintInput.value) || 0;
      const insuranceAnnual = parseFloat(inputs.insuranceInput.value) || 0;

      const lumpsumInvestment = registrationINR + furnishingINR + (housePriceINR - loanAmountINR);
      const monthlyRate = Math.pow(1 + investmentReturns / 100, 1 / 12) - 1;
      const totalMonths = yearsHorizon * 12;

      let sipFV = 0, lumpsumFV = 0, totalRentPaid = 0, totalMovingCost = 0, totalSIPInvested = 0;
      let buySipFV = 0, totalBuySIPInvested = 0; // Additional investment in buy scenario

      // Calculate variable SIP FV month by month
      for (let month = 0; month < totalMonths; month++) {
        const year = Math.floor(month / 12) + 1;
        const monthInYear = month % 12;

        // Rent escalation
        const rentMonthlyAtMonth = currentRentMonthly * Math.pow(1 + rentIncrease / 100, year - 1);
        totalRentPaid += rentMonthlyAtMonth;

        // House costs with escalation
        const houseMaintAtMonth = houseMaintMonthly * Math.pow(1.02, year - 1);
        const societyMaintAtMonth = societyMaintMonthly * Math.pow(1.02, year - 1);
        
        // Moving cost (only in specific months)
        const movingCostThisMonth = (monthInYear === 11 && year % 4 === 0) ? rentMonthlyAtMonth : 0;
        if (movingCostThisMonth > 0) {
          totalMovingCost += movingCostThisMonth;
        }

        // Insurance cost (once at end of year)
        const insuranceCostThisMonth = (monthInYear === 11) ? insuranceAnnual : 0;
        
        // Property tax (once at end of year)
        const propertyTaxThisMonth = (monthInYear === 11) ? (housePriceINR * 0.005) : 0;

        // Calculate SIP for rent scenario (NEW regime - no HRA or interest tax benefits): 
        // (EMI*% + Society Maintenance + House Maintenance + Insurance + Property Tax - Moving - Rent)
        const sipThisMonth = Math.max(0, 
          emiThreshold + 
          societyMaintAtMonth + 
          houseMaintAtMonth + 
          insuranceCostThisMonth + 
          propertyTaxThisMonth - 
          movingCostThisMonth - 
          rentMonthlyAtMonth
        );
        
        totalSIPInvested += sipThisMonth;
        
        // Log first 24 months SIP contribution for debugging
        if (month < 24) {
          console.log(`Month ${month + 1}: SIP = â‚¹${sipThisMonth.toFixed(2)} | EMI*% = â‚¹${emiThreshold.toFixed(2)} | Society Maint = â‚¹${societyMaintAtMonth.toFixed(2)} | House Maint = â‚¹${houseMaintAtMonth.toFixed(2)} | Insurance = â‚¹${insuranceCostThisMonth.toFixed(2)} | Property Tax = â‚¹${propertyTaxThisMonth.toFixed(2)} | Moving = â‚¹${movingCostThisMonth.toFixed(2)} | Rent = â‚¹${rentMonthlyAtMonth.toFixed(2)}`);
        }
        
        // Add this month's SIP contribution to FV (rent scenario)
        const remainingMonths = totalMonths - month;
        sipFV += sipThisMonth * Math.pow(1 + monthlyRate, remainingMonths);

        // Buy scenario additional investment when positive:
        // (Moving + Rent - EMI*% - Society Maint - House Maint - Insurance)
        const buyInvestmentThisMonth = movingCostThisMonth + rentMonthlyAtMonth - emiThreshold - societyMaintAtMonth - houseMaintAtMonth - insuranceCostThisMonth - propertyTaxThisMonth;
        if (buyInvestmentThisMonth > 0) {
          totalBuySIPInvested += buyInvestmentThisMonth;
          buySipFV += buyInvestmentThisMonth * Math.pow(1 + monthlyRate, remainingMonths);
        }
      }

      lumpsumFV = computeLumpsumFutureValue(lumpsumInvestment, investmentReturns, totalMonths);
      const totalInvestmentValue = sipFV + lumpsumFV;
      const rentNetWorth = totalInvestmentValue;

      // Calculate monthly SIP required to reach the final SIP values
      const buySipFVMonthly = calculateMonthlyFromFV(buySipFV, monthlyRate, totalMonths);
      const rentSipFVMonthly = calculateMonthlyFromFV(sipFV, monthlyRate, totalMonths);

      const buyTotalValue = buyHouseValue - buyLoanRemaining + buySipFV;

      outputs.buyEMIResult.textContent = formatINR(emi);
      outputs.buyMonthlySIPResult.textContent = formatINR(buySipFVMonthly);
      outputs.buySIPFVResult.textContent = formatINR(buySipFV);
      outputs.buyTotalValueResult.textContent = formatINR(buyTotalValue);
      outputs.buyNetWorthFinalResult.textContent = formatINR(buyTotalValue);

      outputs.rentLumpsumStartResult.textContent = formatINR(lumpsumInvestment);
      outputs.rentMonthlySIPResult.textContent = formatINR(rentSipFVMonthly);
      outputs.rentLumpsumFVResult.textContent = formatINR(lumpsumFV);
      outputs.rentSIPFVResult.textContent = formatINR(sipFV);
      outputs.rentTotalInvestmentResult.textContent = formatINR(totalInvestmentValue);
      outputs.rentNetWorthFinalResult.textContent = formatINR(rentNetWorth);

      // ========== COMPARISON ==========
      const difference = buyTotalValue - rentNetWorth;
      const winnerLabel = difference >= 0 ? 'Buy' : 'Rent';
      outputs.differenceResult.textContent = `${winnerLabel} (${formatINR(Math.abs(difference))})`;
      outputs.differenceResult.style.color = difference >= 0 ? 'var(--brand)' : '#dc2626';

      renderCharts(yearsHorizon, housePriceINR, loanAmountINR, investmentReturns, emiThreshold, lumpsumInvestment, currentRentMonthly, rentIncrease, buySipFV, tenureYears);
      renderTable(yearsHorizon, housePriceINR, loanAmountINR, investmentReturns, emiThreshold, lumpsumInvestment, currentRentMonthly, rentIncrease, tenureYears);
    }

    function renderCharts(yearsHorizon, housePriceINR, loanAmountINR, investmentReturns, emiThreshold, lumpsumInvestment, currentRentMonthly, rentIncrease, buySipFVTotal, fullTenure) {
      const appreciationRate = parseFloat(inputs.appreciationInput.value || 0);
      const houseMaintMonthly = parseFloat(inputs.houseMaintInput.value) || 0;
      const societyMaintMonthly = parseFloat(inputs.societyMaintInput.value) || 0;
      const insuranceAnnual = parseFloat(inputs.insuranceInput.value) || 0;
      
      const years = [];
      const buyNetWorthData = [];
      const rentNetWorthData = [];

      const monthlyRate = Math.pow(1 + investmentReturns / 100, 1 / 12) - 1;

      // Generate charts for the full tenure
      for (let y = 1; y <= fullTenure; y++) {
        years.push(y);

        // Buy route - calculate additional investment when rent > EMI
        const houseValueAtY = housePriceINR * Math.pow(1 + appreciationRate / 100, y);
        const loanRemainingAtY = y <= cachedYearlyRows.length ? cachedYearlyRows[y - 1]?.closingBalance || 0 : 0;
        
        let buySipFVAtY = 0;
        for (let month = 0; month < y * 12; month++) {
          const yearNum = Math.floor(month / 12) + 1;
          const monthInYear = month % 12;
          const rentAtMonth = currentRentMonthly * Math.pow(1 + rentIncrease / 100, yearNum - 1);
          const houseMaintAtMonth = houseMaintMonthly * Math.pow(1.02, yearNum - 1);
          const societyMaintAtMonth = societyMaintMonthly * Math.pow(1.02, yearNum - 1);
          const movingCostThisMonth = (monthInYear === 11 && yearNum % 4 === 0) ? rentAtMonth : 0;
          const insuranceCostThisMonth = (monthInYear === 11) ? insuranceAnnual : 0;
          const propertyTaxThisMonth = (monthInYear === 11) ? (housePriceINR * 0.005) : 0;

          const buyInvestmentThisMonth = movingCostThisMonth + rentAtMonth - emiThreshold - societyMaintAtMonth - houseMaintAtMonth - insuranceCostThisMonth - propertyTaxThisMonth;
          if (buyInvestmentThisMonth > 0) {
            const remainingMonths = (y * 12) - month;
            buySipFVAtY += buyInvestmentThisMonth * Math.pow(1 + monthlyRate, remainingMonths);
          }
        }
        
        const buyNWAtY = houseValueAtY - loanRemainingAtY + buySipFVAtY;
        buyNetWorthData.push(buyNWAtY);

        // Rent route - calculate variable SIP with new formula
        let sipFVAtY = 0;
        for (let month = 0; month < y * 12; month++) {
          const yearNum = Math.floor(month / 12) + 1;
          const monthInYear = month % 12;
          
          const rentAtMonth = currentRentMonthly * Math.pow(1 + rentIncrease / 100, yearNum - 1);
          const houseMaintAtMonth = houseMaintMonthly * Math.pow(1.02, yearNum - 1);
          const societyMaintAtMonth = societyMaintMonthly * Math.pow(1.02, yearNum - 1);
          
          const movingCostThisMonth = (monthInYear === 11 && yearNum % 4 === 0) ? rentAtMonth : 0;
          const insuranceCostThisMonth = (monthInYear === 11) ? insuranceAnnual : 0;
          const propertyTaxThisMonth = (monthInYear === 11) ? (housePriceINR * 0.005) : 0;
          
          const sipThisMonth = Math.max(0, 
            emiThreshold + 
            societyMaintAtMonth + 
            houseMaintAtMonth + 
            insuranceCostThisMonth + 
            propertyTaxThisMonth - 
            movingCostThisMonth - 
            rentAtMonth
          );
          
          const remainingMonths = (y * 12) - month;
          sipFVAtY += sipThisMonth * Math.pow(1 + monthlyRate, remainingMonths);
        }
        let lumpsumFVAtY = computeLumpsumFutureValue(lumpsumInvestment, investmentReturns, y * 12);
        const rentNWAtY = sipFVAtY + lumpsumFVAtY;
        rentNetWorthData.push(rentNWAtY);
      }

      // Chart 1: Net Worth Comparison
      const ctx1 = document.getElementById('netWorthComparisonChart').getContext('2d');
      if (comparisonChartInstance) comparisonChartInstance.destroy();
      comparisonChartInstance = new Chart(ctx1, {
        type: 'line',
        data: {
          labels: years,
          datasets: [
            {
              label: 'Buy - House Equity',
              data: buyNetWorthData,
              borderColor: '#0d9488',
              backgroundColor: 'rgba(13, 148, 136, 0.1)',
              borderWidth: 2,
              tension: 0.1,
              fill: true
            },
            {
              label: 'Rent + Invest',
              data: rentNetWorthData,
              borderColor: '#8b5cf6',
              backgroundColor: 'rgba(139, 92, 246, 0.1)',
              borderWidth: 2,
              tension: 0.1,
              fill: true
            }
          ]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: true, position: 'top' },
            tooltip: {
              callbacks: {
                label: (ctx) => ctx.dataset.label + ': â‚¹' + (ctx.parsed.y / 100000).toFixed(2) + 'L'
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: { callback: (v) => 'â‚¹' + (v / 100000).toFixed(0) + 'L' }
            },
            x: { title: { display: true, text: 'Years' } }
          }
        }
      });

      // Chart 2: Wealth Growth (Difference: Buy - Rent)
      const ctx2 = document.getElementById('wealthGrowthChart').getContext('2d');
      if (wealthGrowthChartInstance) wealthGrowthChartInstance.destroy();
      
      // Calculate wealth growth difference for each year
      const wealthGrowthData = [];
      for (let i = 0; i < years.length; i++) {
        wealthGrowthData.push(buyNetWorthData[i] - rentNetWorthData[i]);
      }
      
      wealthGrowthChartInstance = new Chart(ctx2, {
        type: 'line',
        data: {
          labels: years,
          datasets: [
            {
              label: 'Wealth Growth (Buy - Rent)',
              data: wealthGrowthData,
              borderColor: '#0d9488',
              backgroundColor: 'rgba(13, 148, 136, 0.1)',
              borderWidth: 3,
              tension: 0.3,
              fill: true,
              pointRadius: 4,
              pointBackgroundColor: '#0d9488'
            }
          ]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: true, position: 'top' },
            tooltip: {
              callbacks: {
                label: (ctx) => {
                  const value = ctx.parsed.y;
                  const sign = value >= 0 ? '+' : '';
                  return 'Wealth Advantage: ' + sign + 'â‚¹' + (value / 100000).toFixed(2) + 'L';
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: { callback: (v) => (v >= 0 ? '+' : '') + 'â‚¹' + (v / 100000).toFixed(0) + 'L' }
            },
            x: { title: { display: true, text: 'Years' } }
          }
        }
      });
    }

    function renderTable(yearsHorizon, housePriceINR, loanAmountINR, investmentReturns, emiThreshold, lumpsumInvestment, currentRentMonthly, rentIncrease, fullTenure) {
      const tableBody = document.getElementById('comparisonTableBody');
      tableBody.innerHTML = '';

      const appreciationRate = parseFloat(inputs.appreciationInput.value || 0);
      const houseMaintMonthly = parseFloat(inputs.houseMaintInput.value) || 0;
      const societyMaintMonthly = parseFloat(inputs.societyMaintInput.value) || 0;
      const insuranceAnnual = parseFloat(inputs.insuranceInput.value) || 0;
      const monthlyRate = Math.pow(1 + investmentReturns / 100, 1 / 12) - 1;

      // Generate table for the full tenure
      for (let y = 1; y <= fullTenure; y++) {
        // Rent route calculations
        const rentMonthlyAtY = currentRentMonthly * Math.pow(1 + rentIncrease / 100, y - 1);
        const annualRentAtY = rentMonthlyAtY * 12;
        let movingCostAtY = 0;
        if (y % 4 === 0) {
          movingCostAtY = rentMonthlyAtY;
        }

        // Calculate variable SIP for this year with new formula
        let sipFVAtY = 0;
        let annualSIPContribution = 0;
        let buySipFVAtY = 0;
        
        for (let month = 0; month < y * 12; month++) {
          const yearNum = Math.floor(month / 12) + 1;
          const monthInYear = month % 12;
          
          const rentAtMonth = currentRentMonthly * Math.pow(1 + rentIncrease / 100, yearNum - 1);
          const houseMaintAtMonth = houseMaintMonthly * Math.pow(1.02, yearNum - 1);
          const societyMaintAtMonth = societyMaintMonthly * Math.pow(1.02, yearNum - 1);
          
          const movingCostThisMonth = (monthInYear === 11 && yearNum % 4 === 0) ? rentAtMonth : 0;
          const insuranceCostThisMonth = (monthInYear === 11) ? insuranceAnnual : 0;
          const propertyTaxThisMonth = (monthInYear === 11) ? (housePriceINR * 0.005) : 0;
          
          const sipThisMonth = Math.max(0, 
            emiThreshold + 
            societyMaintAtMonth + 
            houseMaintAtMonth + 
            insuranceCostThisMonth + 
            propertyTaxThisMonth - 
            movingCostThisMonth - 
            rentAtMonth
          );
          
          if (yearNum === y) {
            annualSIPContribution += sipThisMonth;
          }
          const remainingMonths = (y * 12) - month;
          sipFVAtY += sipThisMonth * Math.pow(1 + monthlyRate, remainingMonths);

          const buyInvestmentThisMonth = movingCostThisMonth + rentAtMonth - emiThreshold - societyMaintAtMonth - houseMaintAtMonth - insuranceCostThisMonth - propertyTaxThisMonth;
          if (buyInvestmentThisMonth > 0) {
            buySipFVAtY += buyInvestmentThisMonth * Math.pow(1 + monthlyRate, remainingMonths);
          }
        }

        const lumpsumFVAtY = computeLumpsumFutureValue(lumpsumInvestment, investmentReturns, y * 12);
        const totalInvestmentAtY = sipFVAtY + lumpsumFVAtY;

        // Buy route calculations
        const houseValueAtY = housePriceINR * Math.pow(1 + appreciationRate / 100, y);
        const loanAmountINRInitial = loanAmountINR || 0;
        const loanTenure = parseFloat(inputs.loanTenureInput.value) || 20;
        const loanRateAnnual = parseFloat(inputs.loanRateInput.value) || 7;
        const monthlyLoanRate = Math.pow(1 + loanRateAnnual / 100, 1 / 12) - 1;
        const totalMonths = loanTenure * 12;
        const emiValue = (loanAmountINRInitial * monthlyLoanRate * Math.pow(1 + monthlyLoanRate, totalMonths)) / (Math.pow(1 + monthlyLoanRate, totalMonths) - 1);
        
        // Calculate remaining balance at year y
        let loanRemainingAtY = loanAmountINRInitial;
        for (let m = 1; m <= Math.min(y * 12, totalMonths); m++) {
          loanRemainingAtY = loanRemainingAtY * (1 + monthlyLoanRate) - emiValue;
        }
        loanRemainingAtY = Math.max(0, loanRemainingAtY);
        
        const houseEquityAtY = houseValueAtY - loanRemainingAtY + buySipFVAtY;
        const differenceAtY = houseEquityAtY - totalInvestmentAtY;

        const tr = document.createElement('tr');
        tr.style.borderBottom = '1px solid var(--border)';
        tr.innerHTML = `
          <td style="padding: 10px 8px; text-align: left; font-weight: 600;">${y}</td>
          <td style="padding: 10px 8px; text-align: right;">${formatINR(rentMonthlyAtY)}</td>
          <td style="padding: 10px 8px; text-align: right;">${formatINR(annualRentAtY)}</td>
          <td style="padding: 10px 8px; text-align: right;">${formatINR(movingCostAtY)}</td>
          <td style="padding: 10px 8px; text-align: right;">${formatINR(annualSIPContribution)}</td>
          <td style="padding: 10px 8px; text-align: right;">${formatINR(lumpsumFVAtY)}</td>
          <td style="padding: 10px 8px; text-align: right;">${formatINR(sipFVAtY)}</td>
          <td style="padding: 10px 8px; text-align: right;"><strong>${formatINR(totalInvestmentAtY)}</strong></td>
          <td style="padding: 10px 8px; text-align: right;">${formatINR(houseValueAtY)}</td>
          <td style="padding: 10px 8px; text-align: right;">${formatINR(loanRemainingAtY)}</td>
          <td style="padding: 10px 8px; text-align: right;"><strong>${formatINR(houseEquityAtY)}</strong></td>
          <td style="padding: 10px 8px; text-align: right; color: ${differenceAtY >= 0 ? 'var(--brand)' : '#dc2626'};"><strong>${formatINR(differenceAtY)}</strong></td>
        `;
        tableBody.appendChild(tr);
      }
    }

    // Year held slider
    const yearsHeldSlider = document.getElementById('yearsHeldSlider');
    const yearsHeldValue = document.getElementById('yearsHeldValue');
    const yearsValue = document.getElementById('yearsValue');
    
    yearsHeldSlider.addEventListener('input', (e) => {
      yearsHeldSlider.dataset.manual = 'true';
      const year = parseInt(e.target.value);
      yearsHeldValue.textContent = year;
      yearsValue.textContent = year;
      
      // Recalculate with selected year
      calculate();
    });

    calculate();

    // Mobile Menu Toggle
    const mobileToggle = document.querySelector('.mobile-menu-toggle');
    const nav = document.querySelector('nav');
    
    if (mobileToggle && nav) {
      mobileToggle.addEventListener('click', function(e) {
        e.stopPropagation();
        nav.classList.toggle('active');
      });
    }
    
    // Close mobile menu when clicking on a link
    const navLinks = document.querySelector('.nav-links');
    if (navLinks) {
      navLinks.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', function() {
          if (nav) nav.classList.remove('active');
        });
      });
    }
    
    // Close mobile menu when clicking outside
    document.addEventListener('click', function(e) {
      if (nav && !e.target.closest('nav') && !e.target.closest('.mobile-menu-toggle')) {
        nav.classList.remove('active');
      }
    });
  </script>
</body>
</html>
